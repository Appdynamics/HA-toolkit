
 Copyright 2016 AppDynamics, Inc

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

--------------------------------------------

Release notes for version 3.0

In addition to bug fixes, the package has been substantially enhanced and 
re-written for enhanced portability, security, performance and maintainability.

The following new functionality is present:

1) replicate optionally can use of non-encrypted rsync.  in environments where 
a VPN or a dedicated network exists between primary and secondary controllers, 
replication can be noticably faster.  this is enabled by using the -U option.

2) mysql replication can use SSL encryption.  a pair of signed certificates 
and keys is exchanged between the 2 mysql instances.  after this negotiation,
all communication for mysql replication is encrypted.

3) mysql replication compression is enabled by default

4) the secondary no longer places replicated traffic in it's bin-logs.  this
greatly decreases disk usage on the secondary

5) scripts and support files are added for NUMA segregation

6) the machine agent is can run as non-root, and automatically is configured
with additional monitors to surface custom mysql and disk metrics. also,
the machine agent is automatically detected if it is in the controller root
directory or it's parent.  we use the controller JVM, so there is no need
to install anything other than the Java-less zip file of the machine agent.

7) configuration of an external monitoring host is simplified

8) support for controller versions greater than 4.2.0, which removed the
plaintext password file for mysql root.  we have 2 distinct solutions to
this:  recreate the db/.rootpw file, or run the save_mysql_passwd.sh script
which obfuscates the password and save that, unscrambling it whenever it is
needed

9) more extensive logging of the replicate process

10) init script configuration is now done via sysconfig files installed in
/etc/sysconfig (for redhat) or /etc/default (for debian).

11) greater compatibility with systemd.  newer linux distributions have a
different implementation of boot time init script handling, which does not
support the clean execution of the service status verb.  this is deprecated
on these systems, and a new script,  HA/appdstatus.sh, is supplied to replace 
this functionality.

Significant bug fixes in this release:

1) files of size less than 1M are checksummed to prevent rsync missing them
if changes to the file did not cause it to grow

2) the database health check now recovers if one of the steps timed out.

3) failover can not longer oscillate between two machines

4) the secondary controller now waits until the relay logs have been executed
before starting the new appserver on failover.   although this can take quite
some time, it prevents database inconsistencies.

------------------------------------
Release notes for version 3.0.1

this is a minor bugfix and enhancement release.

1) added support for fairly ugly root mysql passwords.  whitespace characters
are not supported, but punctuation is ok, plus $*()...

2) failover is a bit smarter about breaking replication.   all things being
otherwise ok, if the old primary has been up at least 1 hour, we don't break
replication

3) in the case of a persistent replication break, if we KNOW that the database
is not damaged on each end, we can run replicate -E to restore the slave to
operation.

4) the machine agent is started with nodename set

5) install_init.sh changes ownership of the machine agent to RUNUSER

6) Documentation on machine agent startup additions

--------------------------------------
Release notes for version 3.1

this is a bugfix version

1) some customer systems had paths with spaces in them.  this broke the machine
agent directory detection.  this code was pulled into a library function.

2) the watchdog.sh did no logging due to a coding error

3) numa machines with numa.settings need to disable the transparent huge page
facility.   this is done in the appdcontroller-db script.

4) some older systems xmllint does not support the --xpath option.  this is
avoided by using the universally available, but uglier, --shell option.

5) a better message is emitted when no password is available

6) README.md, a source hygiene document, was added

--------------------------------------
Release notes for version 3.2

this is a bugfix version

1) backwards compatibility with 3.9 series controllers enhanced

2) a new operations mode, triggered by the presence of HA/SHUTDOWN_FAILOVER,
   will automatically and immediately trigger the secondary to take over
   without breaking replication.   this is intended for external orderly
   shutdown handling of the HA pair as might occur on the azure platform
   support for this is present in appdcontroller init script and a new option
   to the failover.sh script

3) install_init.sh had an error when detecting if the controller uses ports
   less than 1024

4) the failover.sh script waited forever if there was a database replication 
   failure

5) running scripts outside the HA subdirectory printed a spurious error message
   from lib/log.sh

6) replicate.sh now plugs in a tier name into the controller_info.xml for the
   machine agent.

7) mysqlclient.sh now starts up faster for interactive use. an additional 
   option has been added that makes it compatible to controller.sh login-db 
   if line-oriented output is desired.

8) the HA.shar file automatically creates the HA directory if needed, and cd's
   into the HA directory if it is not already there.  it should be unpacked as 
   before, but this behavior is backward compatible and prevents problems.

9) the init scripts were further rationalized with common code removal,
   fixing a problem with memory size complaints and adding automatic setting
   of limits

10) the logging functions had a bug where the existence of /dev/tty was used
    instead of running /usr/bin/tty to test if tty output was possible

--------------------------------------
Release notes for version 3.3

this version adds limited function HA for systems without root escalation
or service installation. this is triggered by the existence of HA/NOROOT.
this functionality is currently undocumented, and failover has had only 
limited testing.

1) a new file, appdservice-noroot.sh, subsumes all the function in the
   appdcontroller, appdcontroller-db and appdynamics-machine-agent init
   scripts.

2) replicate.sh now detects if a file NOROOT is in the HA subdirectory, and
   does not check for init script installation or escalation methods

3) lib/ha.sh modifies the service functions to use the appdservice-noroot.sh
   script instead of using the /sbin/appdservice or sudo code if HA/NOROOT
   exists

4) the mysql monitor installed in the machine agent now searches for a controller
   root directory in /opt/AppDynamics/Controller and /opt/appdynamics/controller
   if it cannot find a definition in an appdynamics-machine-agent.sysconfig files.
   this is a likely case if NOROOT is installed.

--------------------------------------
Release notes for version 3.4

1) the machine agent init script now kills child processes of the machine
   agent.  this avoids leaving orphan monitor scripts running.

2) added the ability to trace the execution of the init scripts by putting
   a file INITDEBUG into the HA directory.  it creates a log file of the
   form /tmp/service_name.out where service_name is one of appdcontroller,
   appdcontroller-db, or appdynamics-machine-agent.

3) a bug in the memory calculation printed a spurious error message.

4) the save_mysql_password script erroneously tried to chmod the obfuscated
   password file.

5) the machine agent disk monitor now works with both 12 and 14 field
   iostat -x output

6) some additional documentation is added listing the commands that are
   added to the sudoers resource.

7) the sysconfig files are now templates.  any custom modifications are
   preserved if a file exists of the form service.sysconfig

8) an informative message is printed when non-root user runs install-init.sh.

--------------------------------------
Release notes for version 3.5

1) the default log expiration time is changed from 8 days to 3 days.  the
   amount of disk space saved is significant, and the use case for keeping
   replication stopped for 8 days is questionable at the very least.

2) the chkconfig and update_rc_d functions are not needed in the sudoers
   file.  they are not invoked by the HA package as non-root.

3) numa-patch-controller.sh gets run automatically when replicate -f is run.

4) when the -m option is explicitly specified, it writes out the monitoring
   definition to the file MONITOR.  Thenceforth, if this file exists, it sets 
   the default monitoring information for the controller and machine agent.

5) the DBOPLIMIT, which controlls the dbopfail test in the watchdog, is
   set to disable the test by default.  it should be enabled for systems
   with SAN attached disk.

6) appdynamics-machine-agent.sh now works on older linuxes that don't support
   ps -h.

7) simplified logging by eliminating the seperate SQL_ERROR path.

--------------------------------------
Release notes for version 3.5.1

1) Catch case when newly compiled /sbin/appdservice does not overwrite incumbent
   by removing old version first.

--------------------------------------
Release notes for version 3.5.2

1) the pesky messages about /root/.forever when trying to stop the appdcontroller
   service is now gone.  it was a coding error.

--------------------------------------
Release notes for version 3.5.3

1) the dbopfail watchdog test is suspect.  it is disabled by default both
   in the watchdog.sh and watchdog.settings.template

--------------------------------------
Release notes for version 3.6

1) the reporting service and events services on the local box were not being
   properly started and stopped by the init script, especially if the script
   in bin/controller.sh was also being used to manage these services.

--------------------------------------
Release notes for version 3.7

1) the watchdog.settings.template has an extensive comment concerning the
   reasons for when the dbop test should be enabled, and disables the test
   by default

2) lib/log.sh now does the password masking using unbuffered sed.  this makes
   the output of replicate.sh in the log file more interactive.

3) a typo in appdynamics-machine-agent.sh rarely would cause the machine agent
   to not start.

4) the machine agent service status now is properly factored out of 
   appdcontroller.sh

5) pbrun is now probed for in /usr/local/bin and /usr/bin

6) if the events directory is renamed, the init script makes no attempt
   to start or stop the events service.

7) a typo prevented explicit huge pages from being allocated

8) numa status is reported by appdstatus.sh on numa machines

9) a syntax change in replicate.sh makes the log slightly less noisy

10) install-init.sh had a syntax error that prevented pbrun from being properly
    detected

11) replicate.sh had a bug that prevented running as root

12) the format for numa.settings.template allows better numa node handling
    by explicitly creating a list of numa nodes that can be interrogated
    in scripts.

13) install-init and replicate.sh now complain when there is ambiguity in 
    finding the correct machine agent.  specify -a to force a specific instance.

14) several minor messages were eliminated or corrected.

15) code to resolve absolute paths now use readlink -e

16) appdservice-noroot.sh was updated to reflect common usage of APPD_ROOT

--------------------------------------
Release notes for version 3.7.1

1) fixed small bug preventing replicate.sh from starting when controller run as root

2) added datetime to end of incremental replicate to simplify determining time taken

--------------------------------------
Release notes for version 3.8

1) refactor of setting the monitoring controller to better support upgrades and
   appdynamics version 4.3.   the code to was pulled out into a new program,
   setmonitor.sh, which is invoked by replicate.sh at final replicate time.

2) appdynamics 4.3 removes network access to the mysql root user.  replicate
   now connects to the mysql instance on the secondary via ssh.

3) the numa.settings template now has defaults to membind instead of preferred.

4) the machine agent init script now removes the log in /tmp before appending
   to it when HA/INITDEBUG exists.

5) if a installation must activate a custom proxy or some other action after
   failover, creating an executable file named failover_hook.sh in the HA
   directory will cause that file to be run after each failover on the new
   primary.

--------------------------------------
Release notes for version 3.9

1) added a bit more flesh to the NOROOT option: INITDEBUG works, sysconfig
   files are read.

2) replace xmllint with xmlstarlet throughout.  much more flexible, as it
   abstracts out both edit and extract of xml documents.

3) cleaner implementation in lib/sql.sh to support controller 4.3; the
   remote sql connection is no longer supported.  now we use ssh.

4) fixes to the abstraction for setmonitor.sh and replicate.

5) watchdog.sh now does a mysql ping using ssh for 4.3.

6) watchdog.sh is more verbose when getting curl errors
   also, connection resets are treated as down.

--------------------------------------
Release notes for version 3.10

1) a tremendous amount of code movement to lib from places where there was duplication.
   essentially, anywhere where a function was defined twice or a variable was defined
   was pulled out into a single place.   this will make maintenance easier.  this is
   mostly visible in the creation of lib/status.sh

2) some variable name rationalization has been carried out.  pidfiles are suffixed _PIDFILE
   consistently, etc.

3) appdservice-noroot.sh had a serious bug in version 3.9 that prevented it from reading 
   the sysconfig files.

4) the package now uses lib/conf.sh to perform almost all config file editing.

5) setmonitor.sh had a real problem with arguments (app_name, etc) that contained spaces 
   or equal signs.

6) we now require the installation of xmlstarlet.

7) the generated application name had a spurious trailing colon.

8) HA now works with the secure credential store in 4.3.

--------------------------------------
Release notes for version 3.11

1) the assassin pid file was not being handled correctly due to a name
   confusion.  to prevent this, pidfiles are now named consistently

2) the controller_info_unset function was missing.

3) support for parallel replication using mysql 5.7
   this is enabled with the -7 option.  a future version will automatically
   detect mysql 5.7.

4) support for mysql 5.7's password obfuscator, which uses mysql_config_editor.

--------------------------------------
Release notes for version 3.12

1) pervasively added setting of PATH to ever user-invoked script to prevent
   running the wrong utility.   a number of sites had customer installations
   of variant, non-linux utilites that broke the HA package.

2) http_proxy environment variables can badly break the watchdog.  we suppress
   this functionality for curl.

3) the watchdog was not started by appdservice-noroot.sh.

4) install-init.sh now produces a log file.

5) the numa.settings.template now has the '=' character in the numactl syntax.

6) a subtle timing bug caused the watchdog to not always start: the parent
   ssh dying before the child could run nohup sends a sighup, which killed
   the watchdog.  this race is inherent in the way ssh and nohup work.

7) duplicate assassins and watchdogs were possible.  this is now prevented.

--------------------------------------
Release notes for version 3.13

1) removed dependency on xmlstarlet, as it has incompatible versions in the
   field and cannot be relied on to work.

--------------------------------------
Release notes for version 3.14 (pi)

1) install-init.sh now fails if HA/NOROOT exists.

2) a bug in appdservice-noroot.sh prevented it from running

3) the INITDEBUG option now creates log files owned by runuser.

4) the replication slave user now has least privilege.

5) the wildcard option in replicate.sh now works again.

--------------------------------------
Release notes for version 3.14.1 (more pi)

1) wildcard really working now.

--------------------------------------
Release notes for version 3.15

1) complete disable of dbop test in watchdog.sh


--------------------------------------
Release notes for version 3.16

1) a number of hard to diagnose HA failures were traced to a setting in the
   db.cnf.  sync_binlog=1 prevents the replication log and the innodb logs
   from being seen as inconsistent should the database crash.

2) the slave_pending_jobs_size_max setting needs to be there to allow the
   replication slave to run in parallel.

3) machine agent status is now reported by the controller init script

4) added options supporting mysql 5.7 parallel replication.

5) setmonitor.sh had an error if there was no crededential password

6) quoting problems arose in lib/conf.sh under certain conditions
   this required a modification in the fundamental runuser functions
   in lib/init.sh and lib/runuser.sh.

--------------------------------------
Release notes for version 3.17

1) more fragility with quoting has been eliminated.

2) the database logs are now saved and recreated whenever replicate is
   finalized.  this means that database logs will not be cluttered with
   historical information.

3) gtid mode is now enabled for the 5.7 databases.

4) setmonitor.sh now allows setting tier name

--------------------------------------
Release notes for version 3.18

1) lib/conf.sh did not correctly delete properties in controller_info.xml;
   this caused the emission of mailformed xml files, and the controllers
   were not monitored properly. this was introduced in 3.14

2) replicate now sets the default path for the mysql socket into the
   data directory.  this fixes a problem with controllers that do not
   start sometimes.

3) setmonitor.sh did not set the primary node name.  if the original
   controller-info.xml did not have a node-name in it, the secondary
   appserver would not be monitored on failover.

--------------------------------------
Release notes for version 3.19

1) the appdcontroller-db.sh init script did not properly start the
   database sometimes due to a hanging ex script.

2) watchdog.sh did not include the lib/status.sh script, so an alias failed.

--------------------------------------
Release notes for version 3.20

1) added watchdog.pid to the replicate excludes.   this prevents a rare
   startup problem
2) fixed a longstanding bug in the watchdog that caused spurious failovers.
3) adjusted the disk_stat.sh monitor to report KB/sec and greatly increased
   the reporting frequency.   this makes the min and max settings useful at
   a much higher measurement overhead,  this still will use less than a tenth
   of a core.
4) added prototype code for hot-sync replicate.  not currently recommended
   or supported.  needs percona xtrabackup and perl-DBD-mysql

--------------------------------------
Release notes for version 3.21

1) Added check within replicate.sh and failover.sh for broken 2-way passwordless 
   ssh between the two HA servers. This helps avoid complex failure cases 
   introduced by server ssh administration changes.

--------------------------------------
Release notes for version 3.22

1) added APPD_UPGRADE to document upgrading the controllers in an HA pair


--------------------------------------
Release notes for version 3.23

1) the APPD_UPGRADE document was greatly expanded
2) a rare replication bug is now prevented by validating .frm and .par files
3) bg_runuser sometimes did not reliably start the watchdog

--------------------------------------
Release notes for version 3.24

1) the ssh validation is broken.  It is bypassed until fixed.

--------------------------------------
Release notes for version 3.25

1) the java installation is not in the controller tree if the platform admin
   app was used to deploy the installation.   intelligence now locates the
   java accordingly. in addition, the database error log was moved.

2) the failover.sh formerly logged the start of the secondary service in
   a confusing manner when starting the watchdog.   this is now quiet, to
   the failover.log only.

3) connected with the fixes for java platform admin. the controller is located
   with a more general regexp in pgrep that will match all controllers.

4) the MONITOR files is copied to the secondary by the setmonitor.sh script

5) NOROOT is removed by a successful run of install-init.sh

6) we now announce the HA version when unpacking the shar file

7) the watchdog.settings file is now being read for overrides of the
   default settings.

8) a long standing syntax error in the pbrun wrapper has been fixed.

KNOWN BUGS:
9) the automatic propagation of the monitoring to the machine agent 
   is not reliable.  do this manually.

--------------------------------------
Release notes for version 3.26

1) the #!/bin/bash was inadvertently removed from replicate.sh

2) a coding error caused replicate.sh to fail when log files do not exist 
   on the secondary.

3) some minor doc fixes

--------------------------------------
Release notes for version 3.27

1) Fixed assorted logging issues to more reliably get messages when things go wrong.

2) Prevent occasional ssh hangs between nodes when new hostnames are used. All
   names and aliases within /etc/hosts are added to ~/.ssh/known_hosts and kept 
   up to date.

3) Prevent occasional MySQL replication failure due to permissions failure when
   new hostnames or aliases are added to /etc/hosts. All aliases for current
   hostname are permitted to connect to MySQL on the other host for replication only.

4) Fixed bug in controller-info.xml update.

5) Automatic backup of all HA Toolkit modified files to same directory 
   with extension ".$(date +%s)".

6) Added option to mysqlclient.sh "-r" to allow the raw pass-through of MySQL client
   command line options - helpful for raw/silent output with mysqlclient.sh -r -s.

7) Fixed bug in Glassfish Java agent monitor config when no -m (monitor) args
   supplied. 

8) Warn at Glassfish startup and shutdown if being run by userid that is not
   the same as expected by MySQL. This helps to fix issues when root is accidentally
   used to start or stop Glassfish which then prevents successful startup by
   subsequent non-root userid. Instructions are provided on how to fix the issue
   if it is detected.

--------------------------------------
Release notes for version 3.27.1

1) catch out of date awk that silently ignores character classes (usually Debian issue)

2) allow spaces within MySQL root password

3) fix bug in "service appdynamics-machine-agent stop" that sometimes killed a running ./replicate.sh

--------------------------------------
Release notes for version 3.27.2

1) patch release to prevent ssh checks from failing replicate if /etc/hosts does
   not contain any host information

2) remove references to symbolic links /dev/stdout or /dev/stderr and avoid errors
   with some sudo use cases

--------------------------------------
Release notes for version 3.27.3

1) check for bad file ownership caused annoying awk error '[:space:]' on some systems

--------------------------------------
Release notes for version 3.27.4

1) patch release to fix broken wildcard -W option

2) extra sanity checks to catch /etc/hosts errors

--------------------------------------
Release notes for version 3.27.5

1) patch release to ensure text for fatal errors get logged

--------------------------------------
Release notes for version 3.27.6

1) patch release to ensure install-init.sh logs appear

--------------------------------------
Release notes for version 3.28

1) if a installation must deactivate a custom proxy or some other action before
   failover, creating an executable file named failover_pre_hook.sh in the HA
   directory will cause that file to be run after before failover on the new
   primary. 

--------------------------------------
Release notes for version 3.28.1

1) fixed missing LOGFNAME for noroot use case

--------------------------------------
Release notes for version 3.28.2

1) fixed missing application name for internal monitoring when there is a space in the application name

2) fixed setting appdynamics.controller.services.hostName and appdynamics.controller.services.port to external VIP host and port respectively

--------------------------------------
Release notes for version 3.28.3

1) fixed minor bug that kept adding rows to /etc/pam.d/common-session

2) removed '-l' option to su that does full login setup for process that conflicted with environments with stty in startup scripts or fell foul of RH 7.4 security preventing functional users from doing su -l during ssh call.

--------------------------------------
Release notes for version 3.28.4

1. fixed ability of Toolkit to interoperate with MySQL v5.7 native password storage. 
   Enable all stored password handling as usual with cd HA; ./save_mysql_passwd.sh

2. patched db.cnf config updater to cope with missing newlines - sometimes emitted by EC

3. excluded db/mysql.pid from replication to allow reliable MySQL shutdown on secondary

--------------------------------------
Release notes for version 3.28.5

1. patch for https://github.com/Appdynamics/HA-toolkit/issues/77 which wrongly failed 
   replicate finalise if same hostname alias existed in different domain names

--------------------------------------
Release notes for version 3.28.6

1. trivial add of APPD_UPGRADE file to distribution artifact

--------------------------------------
Release notes for version 3.28.7

1. added support for the doublewrite file that can be configured to optional
database implementations.

--------------------------------------
Release notes for version 3.29

1. added an interlock so that multiple replicate instances cannot run

2. made the ibd file checksum on large files a bit stronger.  if the first 
   block is not identical, prune the file.

3. suppressed a misleading noisy diagnostic

--------------------------------------
Release notes for version 3.29.1

1. added a check to abort on undecoded arguments on command line.

--------------------------------------
Release notes for version 3.30

1. with mysql 5.7, password warnings broke the get function in lib/status.sh
   the init scripts should now work as designed.  after installing mysql 5.7,
   running save_mysql_password will eliminate the warnings.

2. when running replicate -j, the secondary license file is no longer clobbered

3. replicate -j will now update the secondary controller-info.xml with the right
   node-name.

4. replicate -j now deletes the generated and osgi-cache directories

5. more hardening for tcsh login shell

--------------------------------------
Release notes for version 3.31

1) a rare bug prevented files from being properly pruned on the secondary.  this caused
   the secondary database to not start due to space id collisions.

2) failover.sh in some cases left the global_configuration_local in an odd state.
   the new version has a cleaner state transition if the remote database crashes during the failover,
   not an unusual thing if the primary is corrupt and in a crash-restart loop.

3) appdservice-noroot.sh now reports when the assassin is being started

--------------------------------------
Release notes for version 3.32

1) the APPD_UPGRADE document now more accurately describes the steps that must be undertaken to
   upgrade the controller.  specifically, added a halt to the primary database and installation
   of the obfuscated mysql password.

2) certain installations require a hook to modify the execution path for ssh/scp.   
   this is now explicitly done via the addition of a optional configuration file, HA_ENVIRONMENT.   
   this config file is sourced by the package automatically.

3) a missing redirection caused the file pruning code in version 3.31 to not work

--------------------------------------
Release notes for version 3.33

1) we now verify that the secondary database has indeed been marked passive before completing the
   HA setup.   this greatly narrows a race condition that could cause a split brain.

2) we add a means of disabling the bidirectional ssh checks for installations that cannot install the
   primary and secondary hosts into the host files.

--------------------------------------
Release notes for version 3.34

1) numa-patch-controller.sh now also patches the events and reporting services
   to run on the java node

2) appdstatus.sh now does not attempt to get the numastat of non-runuser 
   processes.

3) replicate -j now added to replicate help.

--------------------------------------
Release notes for version 3.35

1) a longstanding bug prevented reliable data file pruning on old linuxes
   which behaved differently running the find command.  the rewrite of this
   code avoids using this functionality, and is much shorter and simpler.

2) some vestigial testing code was removed

3) the init scripts now fail quickly if the db.cnf is missing

--------------------------------------
Release notes for version 3.36

1) older versions of /usr/bin/dd do not support the status=none option. this broke the replication
   file pruning code.  I added the trivial fix of redirecting stderr to /dev/null.

--------------------------------------
Release notes for version 3.37

1) a dependency on locale makes the pruning code collation order dependent.   I eliminate the problem
   by sorting only on the primary.   this fixes an excessive pruning problem.

--------------------------------------
Release notes for version 3.38

1) false negatives in the pruning process cause replication failures.  I checksum now 256K unconditionally.

--------------------------------------
Release notes for version 3.39

1) the HA_ENVIRONMENT file did not need the execute bit

2) ssh was directly invoked in the cleanup function.  it should use $SSH.

--------------------------------------
Release notes for version 3.40

1) a missed line continuation caused the secondary to not remove ibdata1 and 
   logs from the secondary when replicating.   in addition to being a source
   of noise, this could cause a bad replicate in some rare situations.

--------------------------------------
Release notes for version 3.41

1) the new marker file NO_MACHINE_AGENT suppresses all processing related
   to the machine agent; the machine agent is not started, stopped, or 
   configured by this package if this file is present.   if your replicate
   or other logs mention "machine agent suppressed", then this file exists
   in your HA directory.

2) a new script, appdservice.sh, is a one-size-fits-all wrapper for service
   changes.  whatever flavor of service invocation your system is configured
   for, appdservice.sh <service> <action> should do the right thing.

3) a new document, PATCHING, now describes the best practices for managing
   system patching or system maintenance of an HA pair.

--------------------------------------
Release notes for version 3.42

1) A longstanding bug allowed replication from a broken secondary onto
   a good primary if the user tried to do so with the secondary database
   stopped.   This is now much more definitive.

2) a detailed analysis of the innodb file pruning code exposed an issue
   that sometimes did not detect when the primary and secondary files
   were not identical.   this caused the secondary database to either
   not start, or entered into a crash-restart loop.   the new pruner
   now calculates a sha1 of all the innodb file extent maps and insert 
   buffer bitmaps.  in combination with the payload in the file header,
   log sequence numbers, and so on, any stale files on the secondary will
   be detected and pruned before the rsync.

--------------------------------------
Release notes for version 3.43

1) Fixed 'Access denied' message in primary's database.log caused by watchdog.sh 
   failing to call mysqladmin ping via ssh. This issue only appears with v5.7
   MySQL.

2) Tidied up few small issues and enhanced some error messages to be easier to 
   self remediate.

--------------------------------------
Release notes for version 3.43.1

1) Fixed bug within replicate.sh -E facility to re-enable replication after primary 
   was turned off and assassin.sh had then disabled it upon finding it back up.
   Secondary DB will now be started.

--------------------------------------
Release notes for version 3.44

1) better descriptive message in replicate startup.

2) file map processing now checksums 32k at eof

3) improved the code in appdservice-noroot.sh to handle machine agent and server
   configuration.

4) added code to appdservice-noroot.sh to forcibly kill appserver if it won't 
   stop normally.

--------------------------------------
Release notes for version 3.45

1) appdservice-noroot.sh did not properly detect the machine agent jar file.
   the symptom is that it complained, even though the file exists.

--------------------------------------
Release notes for version 3.45.1

1) Fix for HA Toolkit issue #99 i.e. https://bugs.mysql.com/bug.php?id=74691
   which loses user entered password characters with v5.7 MySQL that follow #

--------------------------------------
Release notes for version 3.46

1) documentation fixes README.txt, correcting the URL for the health rule,
   adding a description of the failover hooks, and minor formatting.

2) documentation addition in RUNBOOK describing the process for detecting and
   fixing the REPLICATION BROKEN state.

--------------------------------------
Release notes for version 3.47

1) Fix to ignore mds_license.enterprise_license from list of tables being replicated

2) Fix to delete contents of osgi-cache and generated directories before starting appserver, both for service and NOROOT options

--------------------------------------
Release notes for version 3.48

1) update replicate table ignore settings to be consistent with new v4.5.6 controller.mqs_* tables

2) Added replicate error 1237 to ignore list to suppress: "Slave SQL thread ignored the query because of replicate-*-table rules" type messages

--------------------------------------
Release notes for version 3.49

1) added a call to date to logmsg.  this will tag every log with a timestamp
   useful for correlating with system changes, like reboots, bad guy logins,
   and so on.

--------------------------------------
Release notes for version 3.50

1) added initial scalability support for MySQL datadir file difference checking (discrepency counting).
   Default now is to split file checksumming into as many pieces as there are CPUs and run in parallel
   on both HA servers at same time. Control more finely with -P x,y replicate.sh option. 
   See 'while getopts' section in replicate.sh for parameter description.

2) fixed lack of checking of /etc/{default,sysconfig}/app* for currency. This permitted Toolkit to
   be updated and then fail later because the APPD_ROOT or RUNUSER values had changed.

--------------------------------------
Release notes for version 3.51

1) v4.5.6+ controllers require updated 'replication ignore' configs to ensure they replicate *all* tables.
   This release includes a check for that condition, an automated attempt to make the update else it prints
   the manual instructions to screen and logs. Check called within replicate.sh or directly via:
   check_breaking_changes.sh

--------------------------------------
Release notes for version 3.52

1) Fixed minor Debian compatibility issues

--------------------------------------
Release notes for version 3.53

1) redefined seconds behind master custom metric to have 999999 be the value
   that denotes broken replication.  this is a hack, but a reasonable one.

--------------------------------------
Release notes for version 3.54

1) Added incremental and finalise replicate parallel rsync facility for just MySQL datadir. Defaults to no
   rsync parallelism. Enable with "./replicate.sh ... -P r6" to get 6 parallel rsyncs running for datadir only.
   Separate parameterisation for parallel running of checksum and rsync e.g. -P c10,r5 to get 10-way parallel 
   checksum and 5-way parallel rsync.
   If you observe 'ssh_exchange_identification' errors then increase secondary/both ssh server's 
   /etc/ssh/sshd_config:MaxStartups config value so the first colon separated value is at least as big as the
   desired rsync parallel level.

--------------------------------------
Release notes for version 3.54

1) a subtle bug prevented the replication with mysql 5.7 from activating if the datadir was contained in the 
   controller subdirectory, but not in the db subdirectory.  for example, if datadir was installed as 
   <controller root>/data, replication failed to provision.  this is because the auto.cnf file was copied as
   part of the appserver rsync.  now the appserver sync explicitly excludes $datadir.

--------------------------------------
Release notes for version 3.55

1) the pruning code was a little too lazy:  it turns out that the 2 blocks
   at the start of the .ibd file is not enough to pick up changes that are
   important.  the pruner is now a bit more intelligent about what is summed.

2) the order of the controller rsyncing messages make a little more sense.

--------------------------------------
Release notes for version 3.55a

1) I'm breaking with the versioning scheme for a simple patch that will help us isolate a performance problem
   seen at one site.  there is no great need to upgrade to this version.

--------------------------------------
Release notes for version 3.56

1) Parallel replicate patch that improves average performance. It does a better job of distributing 
   work to each thread so that a worker thread is less often going to finish early.

